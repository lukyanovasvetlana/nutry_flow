# Документация экрана MealDetails

## Обзор

Экран `MealDetailsScreen` предоставляет подробную информацию о блюде, включая пищевую ценность, ингредиенты, инструкции по приготовлению и полезные советы.

## Расположение файлов

- **Основной экран**: `lib/features/meal_plan/presentation/screens/meal_details_screen.dart`
- **Тесты**: `test/meal_details_screen_test.dart`
- **Тесты навигации**: `test/dashboard_meal_details_navigation_test.dart`

## Функциональность

### Основные возможности

1. **Отображение информации о блюде**:
   - Название блюда
   - Изображение (placeholder с градиентом)
   - Рейтинг и отзывы
   - Время приготовления
   - Количество порций
   - Сложность приготовления

2. **Пищевая ценность**:
   - Калории
   - Белки, жиры, углеводы
   - Клетчатка и сахар
   - Цветовая индикация для разных макронутриентов

3. **Ингредиенты**:
   - Список всех ингредиентов
   - Количество каждого ингредиента
   - Визуальные индикаторы (зеленые точки)

4. **Инструкции по приготовлению**:
   - Пошаговые инструкции
   - Нумерованные шаги
   - Четкое форматирование

5. **Полезные советы**:
   - Информация о пользе блюда
   - Советы по питанию
   - Иконки для улучшения восприятия

6. **Действия пользователя**:
   - Добавление в план питания
   - Добавление ингредиентов в список покупок
   - Добавление в избранное
   - Поделиться рецептом

## Навигация

### Переход к экрану

Экран доступен через меню дашборда:
1. Нажмите на FloatingActionButton (кнопка меню) в дашборде
2. Выберите пункт "Детали блюда"
3. Экран откроется с примером блюда "Здоровый завтрак"

### Возврат к дашборду

- Нажмите кнопку "Назад" в AppBar
- Произойдет переход к главному экрану приложения

## Дизайн

### Цветовая схема

- **Фон**: `Color(0xFFF9F4F2)` (светло-бежевый)
- **Карточки**: Белый цвет с тенью
- **Акценты**: Зеленый цвет `AppColors.button`
- **Текст**: Черный и серый для контраста

### Компоненты UI

1. **AppBar**:
   - Прозрачный фон
   - Кнопка назад (черная)
   - Заголовок "Детали блюда"
   - Кнопки избранного и поделиться

2. **Карточки информации**:
   - Скругленные углы (12px)
   - Белый фон
   - Легкая тень
   - Внутренние отступы 16px

3. **Кнопки действий**:
   - Основная кнопка: зеленый фон, белый текст
   - Вторичная кнопка: белый фон, зеленая граница

## Данные

### Структура данных блюда

```dart
Map<String, dynamic> mealData = {
  'name': 'Здоровый завтрак',
  'calories': 450,
  'protein': 25,
  'carbs': 35,
  'fat': 15,
  'fiber': 8,
  'sugar': 12,
  'cookingTime': 25,
  'servings': 2,
  'difficulty': 'Средняя',
  'ingredients': [
    {'name': 'Овсяные хлопья', 'amount': '1 стакан'},
    // ...
  ],
  'instructions': [
    'Залейте овсяные хлопья молоком и оставьте на 5 минут',
    // ...
  ],
  'nutritionTips': [
    'Богат клетчаткой для улучшения пищеварения',
    // ...
  ],
};
```

### Параметры конструктора

- `mealId` (String?, optional): ID блюда для загрузки из API
- `mealName` (String?, optional): Название блюда для отображения

## Состояния экрана

### Состояние загрузки

- Показывается `CircularProgressIndicator`
- Симулируется задержка в 1 секунду
- Загружаются мок-данные

### Состояние с данными

- Отображается полная информация о блюде
- Все секции доступны для взаимодействия
- Кнопки активны

## Взаимодействие

### Пользовательские действия

1. **Добавить в план питания**:
   - Показывается SnackBar с подтверждением
   - TODO: Интеграция с системой планирования

2. **Добавить в список покупок**:
   - Показывается SnackBar с подтверждением
   - TODO: Интеграция с системой покупок

3. **Добавить в избранное**:
   - TODO: Реализация функциональности избранного

4. **Поделиться**:
   - TODO: Интеграция с системой шаринга

## Тестирование

### Покрытие тестами

Создано 13 тестов, покрывающих:

1. **Состояние загрузки**:
   - Отображение индикатора загрузки
   - Корректный заголовок

2. **Отображение данных**:
   - Все секции информации
   - Пищевая ценность
   - Ингредиенты
   - Инструкции
   - Советы по питанию

3. **Взаимодействие**:
   - Кнопки действий
   - SnackBar уведомления
   - Навигация назад

4. **UI элементы**:
   - AppBar кнопки
   - Рейтинг
   - Быстрая информация

### Тесты навигации

Создано 5 тестов для навигации:

1. **Переход из дашборда**:
   - Открытие меню
   - Выбор пункта "Детали блюда"
   - Переход к экрану

2. **Передача параметров**:
   - Корректное отображение названия блюда

3. **Возврат к дашборду**:
   - Работа кнопки назад

4. **Отображение меню**:
   - Корректная иконка и текст

5. **Закрытие меню**:
   - Автоматическое закрытие при переходе

## Будущие улучшения

### Планируемые функции

1. **Интеграция с API**:
   - Загрузка реальных данных о блюдах
   - Обработка ошибок загрузки

2. **Изображения**:
   - Загрузка реальных изображений блюд
   - Кэширование изображений

3. **Персонализация**:
   - Избранные блюда
   - История просмотров
   - Рекомендации

4. **Социальные функции**:
   - Отзывы и рейтинги
   - Комментарии
   - Поделиться в соцсетях

5. **Расширенная функциональность**:
   - Таймер приготовления
   - Пошаговый режим готовки
   - Голосовые подсказки

## Архитектура

### Структура кода

```
lib/features/meal_plan/presentation/screens/meal_details_screen.dart
├── MealDetailsScreen (StatefulWidget)
├── _MealDetailsScreenState
│   ├── _loadMealDetails() - загрузка данных
│   ├── _buildMealImage() - изображение блюда
│   ├── _buildMealHeader() - заголовок и рейтинг
│   ├── _buildQuickInfo() - быстрая информация
│   ├── _buildNutritionInfo() - пищевая ценность
│   ├── _buildIngredients() - ингредиенты
│   ├── _buildInstructions() - инструкции
│   ├── _buildNutritionTips() - советы
│   └── _buildActionButtons() - кнопки действий
```

### Зависимости

- `flutter/material.dart` - UI компоненты
- `nutry_flow/shared/theme/app_colors.dart` - цветовая схема
- `../../../../app.dart` - основной контейнер приложения

## Заключение

Экран `MealDetailsScreen` предоставляет богатую информацию о блюдах с интуитивным интерфейсом и удобной навигацией. Он готов к интеграции с реальными данными и может быть легко расширен новой функциональностью.

Все тесты проходят успешно, что обеспечивает стабильность и надежность компонента. 