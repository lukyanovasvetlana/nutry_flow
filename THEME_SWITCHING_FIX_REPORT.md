# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º —Å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã

## üö® –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã —ç–∫—Ä–∞–Ω—ã –ø–æ–¥–∫–ª—é—á–∞–ª–∏—Å—å –Ω–∞–ø–æ–ª–æ–≤–∏–Ω—É, —Ü–≤–µ—Ç–∞ –º–µ–Ω—è–ª–∏—Å—å –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é, –∏ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –ø—Ä–æ–ª–∏—Å—Ç—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫—Ä–∞–Ω–æ–≤ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–æ–≤
- `ThemeManager` —É–≤–µ–¥–æ–º–ª—è–ª –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö, –Ω–æ –Ω–µ –≤—Å–µ –≤–∏–¥–∂–µ—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª–∏
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ UI –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–µ–º—ã
- –ù–µ –±—ã–ª–æ –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã

### 2. –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
- `ListenableBuilder` –Ω–µ –∏–º–µ–ª –º–µ—Ö–∞–Ω–∏–∑–º–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `MaterialApp` –Ω–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞–ª—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–µ–º—ã
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –£–ª—É—á—à–µ–Ω ThemeManager
```dart
/// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ç–µ–º—É
Future<void> setTheme(ThemeMode theme) async {
  if (_currentTheme != theme) {
    // –°–Ω–∞—á–∞–ª–∞ —É–≤–µ–¥–æ–º–ª—è–µ–º –æ –Ω–∞—á–∞–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
    notifyListeners();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–º—É
    _currentTheme = theme;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º ThemeTokens
    ThemeTokens.currentTheme = _currentTheme;
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ SharedPreferences
    await _saveThemeToStorage();
    
    // –£–≤–µ–¥–æ–º–ª—è–µ–º –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
    await Future.delayed(const Duration(milliseconds: 50));
    notifyListeners();
  }
}
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–≤–æ–π–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –≤ –Ω–∞—á–∞–ª–µ –∏ –≤ –∫–æ–Ω—Ü–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
- –ó–∞–¥–µ—Ä–∂–∫–∞ 50ms –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
- –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π `toggleTheme()` —á–µ—Ä–µ–∑ `setTheme()`

### 2. –£–ª—É—á—à–µ–Ω main.dart
```dart
return MaterialApp(
  title: 'NutryFlow',
  theme: lightTheme,
  darkTheme: darkTheme,
  themeMode: currentTheme,
  // –î–æ–±–∞–≤–ª—è–µ–º key –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–µ–º—ã
  key: ValueKey('theme-${currentTheme.name}'),
  routes: { ... },
);
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω `ValueKey` –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è `MaterialApp`
- –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–µ–º –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–µ–º—ã

### 3. –£–ª—É—á—à–µ–Ω AppContainer
```dart
return _buildMainScreen(key: ValueKey('app-container-${currentTheme.name}'));

Widget _buildMainScreen({Key? key}) {
  return Scaffold(
    key: key, // –î–æ–±–∞–≤–ª—è–µ–º key –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    // ...
  );
}
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω `ValueKey` –¥–ª—è `Scaffold`
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–µ–º—ã
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã

### 4. –î–æ–±–∞–≤–ª–µ–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
```dart
onPressed: () async {
  // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Ç–µ–º—ã
  ScaffoldMessenger.of(context).showSnackBar(
    SnackBar(
      content: Text(
        ThemeManager().currentTheme == ThemeMode.light 
            ? '–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ç–µ–º–Ω—É—é —Ç–µ–º—É...' 
            : '–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É...',
      ),
      duration: const Duration(milliseconds: 500),
    ),
  );
  
  await ThemeManager().toggleTheme();
},
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- SnackBar —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ç–µ–∫—Å—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–π —Ç–µ–º—ã
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å 500ms –¥–ª—è –ª—É—á—à–µ–≥–æ UX

## üîÑ –ö–∞–∫ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã**
2. **–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è SnackBar** —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ –ø—Ä–æ—Ü–µ—Å—Å–µ
3. **ThemeManager —É–≤–µ–¥–æ–º–ª—è–µ—Ç** –æ –Ω–∞—á–∞–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
4. **–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ç–µ–º–∞** –∏ ThemeTokens
5. **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ SharedPreferences**
6. **–ó–∞–¥–µ—Ä–∂–∫–∞ 50ms** –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
7. **ThemeManager —É–≤–µ–¥–æ–º–ª—è–µ—Ç** –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
8. **ListenableBuilder –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç** MaterialApp —Å –Ω–æ–≤—ã–º key
9. **AppContainer –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è** —Å –Ω–æ–≤—ã–º key
10. **–í—Å–µ —ç–∫—Ä–∞–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è** —Å –Ω–æ–≤–æ–π —Ç–µ–º–æ–π

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ **–ü–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–æ–≤** –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Ç–µ–º—ã
- ‚úÖ **–ù–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è** —Ü–≤–µ—Ç–æ–≤
- ‚úÖ **–ò–Ω–¥–∏–∫–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞** –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
- ‚úÖ **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** UI —á–µ—Ä–µ–∑ ValueKey
- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞** –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ **–î–≤–æ–π–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ** –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ç–µ–º–Ω—É—é —Ç–µ–º—É
1. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
2. –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è SnackBar "–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ç–µ–º–Ω—É—é —Ç–µ–º—É..."
3. –í—Å–µ —ç–∫—Ä–∞–Ω—ã –¥–æ–ª–∂–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–∏—Ç—å—Å—è
4. –¶–≤–µ—Ç–∞ –¥–æ–ª–∂–Ω—ã –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –≤–µ–∑–¥–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É
1. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
2. –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è SnackBar "–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É..."
3. –í—Å–µ —ç–∫—Ä–∞–Ω—ã –¥–æ–ª–∂–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–∏—Ç—å—Å—è
4. –¶–≤–µ—Ç–∞ –¥–æ–ª–∂–Ω—ã –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –≤–µ–∑–¥–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É
2. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –¥—Ä—É–≥–æ–π —ç–∫—Ä–∞–Ω
3. –¶–≤–µ—Ç–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ —Å—Ä–∞–∑—É
4. –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã –Ω–∞ –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–∞—Ö
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–≤–µ—Ç–æ–≤
3. **–£–±–µ–¥–∏—Ç—å—Å—è** —á—Ç–æ –Ω–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
4. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å** –∑–∞–¥–µ—Ä–∂–∫—É –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
5. **–î–æ–±–∞–≤–∏—Ç—å** –∞–Ω–∏–º–∞—Ü–∏—é –ø–µ—Ä–µ—Ö–æ–¥–∞ –º–µ–∂–¥—É —Ç–µ–º–∞–º–∏

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **–î–≤–æ–π–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ**: `notifyListeners()` –≤ –Ω–∞—á–∞–ª–µ –∏ –∫–æ–Ω—Ü–µ
- **–ó–∞–¥–µ—Ä–∂–∫–∞**: `Future.delayed(Duration(milliseconds: 50))`
- **ValueKey**: `'theme-${currentTheme.name}'` –¥–ª—è MaterialApp
- **ValueKey**: `'app-container-${currentTheme.name}'` –¥–ª—è AppContainer
- **SnackBar**: –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
- **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: —á–µ—Ä–µ–∑ –∫–ª—é—á–∏ –¥–ª—è –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –≤–∏–¥–∂–µ—Ç–æ–≤
