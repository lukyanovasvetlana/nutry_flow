# Задача: Корректировка курса (Correct Course Task, Flutter/Chibis App)

## Назначение

- Провести структурированный анализ изменений с помощью `change-checklist`.
- Проанализировать влияние изменений на эпики, артефакты проекта и MVP с учётом структуры чек-листа и особенностей мобильного Flutter-приложения (feature-based архитектура, BLoC, Supabase, Firebase, CI/CD, тестирование, документация, UX, мобильные best practices).
- Предложить возможные решения (например, скорректировать scope, откатить элементы, пересобрать фичи) по подсказкам чек-листа.
- Сформировать конкретные, реализуемые предложения по обновлению затронутых артефактов (эпики, user stories, разделы PRD, архитектуры и др.).
- Подготовить консолидированный документ "Sprint Change Proposal" с анализом влияния и чётко оформленными предложениями для ревью и утверждения.
- Обеспечить понятный путь передачи задачи, если изменения требуют фундаментального перепланирования (например, для PM или архитектора).

## Инструкции

### 1. Старт и выбор режима

- **Подтверждение задачи и входных данных:**
  - Подтверди с пользователем запуск задачи "Корректировка курса" (Change Navigation & Integration).
  - Уточни триггер изменений, получи объяснение проблемы и её предполагаемое влияние.
  - Убедись, что есть доступ ко всем релевантным артефактам (PRD, эпики/stories, архитектура, UI/UX-спеки) и к `change-checklist`.
- **Выбор режима взаимодействия:**
  - Спроси пользователя, как работать:
    - **Инкрементально (по умолчанию):** Проходить чек-лист по секциям, обсуждать выводы и совместно формулировать предложения по каждой части.
    - **YOLO-режим:** Провести батч-анализ по чек-листу и выдать консолидированный отчёт и предложения для ревью.
  - Дождись выбора пользователя и подтверди режим.
- **Объясни процесс:** Кратко опиши: "Мы используем `change-checklist` для анализа изменений и подготовки предложений. Я проведу вас по пунктам чек-листа в выбранном режиме."
  <critical_rule>Если задаёшь несколько вопросов или пунктов для ответа — нумеруй их для удобства пользователя.</critical_rule>

### 2. Анализ по чек-листу (по выбранному режиму)

- Системно проходи секции 1-4 `change-checklist` (обычно: контекст изменений, анализ влияния на эпики/stories, разрешение конфликтов артефактов, выбор пути).
- Для каждого пункта или группы:
  - Покажи соответствующий prompt/вопрос из чек-листа.
  - Запроси нужную информацию, анализируй артефакты (PRD, эпики, архитектура, история stories и др.) с учётом Flutter-специфики.
  - Обсуди выводы с пользователем.
  - Зафиксируй статус пункта чек-листа ([x] Выполнено, [N/A], [!] Требуется действие) и важные решения.
  - Совместно согласуйте "Рекомендуемый путь" (Section 4 чек-листа).

### 3. Формулировка предложений по изменениям

- На основе анализа (Sections 1-4) и согласованного пути:
  - Определи, какие артефакты требуют обновления (эпики, stories, разделы PRD, архитектуры, диаграммы и др.).
  - **Сформулируй конкретные предложения по каждому артефакту:**
    - Переписать текст user story, acceptance criteria, приоритет
    - Добавить/удалить/переставить/разделить stories в эпиках
    - Обновить архитектурные диаграммы (например, mermaid-блок или текстовое описание изменений)
    - Обновить списки технологий, конфиги, разделы PRD/архитектуры
    - Добавить новые supporting-артефакты (например, краткое решение по интеграции Supabase)
  - В инкрементальном режиме — обсуждай и дорабатывай предложения по мере их подготовки
  - В YOLO — собери все предложения для финального показа

### 4. Формирование "Sprint Change Proposal"

- Синтезируй анализ по чек-листу (Sections 1-4) и все согласованные предложения в единый документ "Sprint Change Proposal" (структура — см. Section 5 change-checklist).
- В документе должны быть:
  - **Сводка анализа:** Краткое описание исходной проблемы, её влияния (на эпики, артефакты, MVP), обоснование выбранного пути
  - **Конкретные предложения:** Для каждого артефакта — чётко покажи/опиши изменения ("Изменить Story X.Y: [старый текст] → [новый текст]", "Добавить acceptance criteria в Story A.B: [текст]", "Обновить раздел 3.2 архитектуры: [новый текст/диаграмма]")
- Покажи draft "Sprint Change Proposal" пользователю для финального ревью и доработки

### 5. Финализация и следующие шаги

- Получи явное одобрение пользователя на "Sprint Change Proposal" и все предложения
- Передай финальный документ пользователю
- **В зависимости от характера изменений:**
  - **Если изменения можно реализовать напрямую или оформить через PO/SM:** Сообщи, что задача "Корректировка курса" завершена, и пользователь может приступить к реализации/логированию изменений. При необходимости — предложи передать задачу PO/SM для организации backlog.
  - **Если требуется фундаментальное перепланирование (например, крупный архитектурный рефакторинг):** Явно сообщи об этом. Порекомендуй привлечь PM или архитектора, используя "Sprint Change Proposal" как вход для дальнейшего планирования.

## Выходные артефакты

- **Основной:** Документ "Sprint Change Proposal" (markdown), включающий:
  - Сводку анализа по чек-листу (проблема, влияние, обоснование)
  - Конкретные предложения по всем затронутым артефактам
- **Неявно:** Аннотированный `change-checklist` (или запись его прохождения) с выводами и решениями
