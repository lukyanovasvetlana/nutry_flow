# Задача: Core Dump (Flutter приложение)

## Назначение

Создать краткий файл памяти (`.ai/core-dump-n.md`), фиксирующий ключевой контекст текущей сессии агента для бесшовного продолжения работы в будущем. Это обеспечивает сохранение мобильного Flutter-контекста между сессиями и минимизирует расход токенов при загрузке.

## Входные данные для задачи

- История текущей сессии и достигнутые результаты
- Список файлов, созданных, изменённых или удалённых за сессию
- Ключевые решения и применённые процедуры
- Текущее состояние проекта и следующие логические шаги
- Запросы пользователя и ответы агента, повлиявшие на ход работы

## Инструкции по выполнению задачи

### 0. Проверка существующего core dump

Перед началом проверь, существует ли `.ai/core-dump.md`:

- Если файл есть, спроси пользователя: "Файл core dump уже существует. Как поступить? 1. Перезаписать, 2. Обновить, 3. Добавить как новую сессию, 4. Создать новый файл?"
  - **Перезаписать**: Полностью заменить содержимое новым
  - **Обновить**: Объединить новую информацию с существующей, обновить релевантные секции
  - **Добавить**: Вставить новую сессию отдельным блоком, сохранив старое
  - **Создать новый**: Создать новый файл с увеличенным номером (например, core-dump-3.md, если есть 1 и 2)
- Если файла нет — создай `.ai/core-dump-1.md`

### 1. Анализ контекста сессии

- Просмотри всю переписку, выдели ключевые достижения
- Зафиксируй выполненные задачи, процедуры, сценарии
- Отметь важные решения, решённые проблемы
- Зафиксируй стиль работы и предпочтения пользователя (например, акцент на feature-based архитектуре, BLoC, Supabase, CI/CD, тестировании, документации, UX)

### 2. Документирование достигнутого

- **Основные действия**: Кратко перечисли главные завершённые задачи
- **Прогресс по stories**: Для работы по stories используй формат "Выполнено: 1-6, 8. Следующее: 7, 9"
- **Решение проблем**: Опиши, какие сложности возникли и как были решены
- **Коммуникация с пользователем**: Суммируй ключевые запросы, предпочтения, важные обсуждения

### 3. Фиксация изменений в файловой системе (кратко)

- **Созданные файлы**: `имя_файла.ext` (назначение/размер)
- **Изменённые файлы**: `имя_файла.ext` (что изменено)
- **Удалённые файлы**: `имя_файла.ext` (причина удаления)
- Фокусируйся на сути, избегай избыточных описаний

### 4. Фиксация текущего состояния проекта

- **Прогресс проекта**: Где находится проект после этой сессии
- **Текущие проблемы**: Блокеры или нерешённые вопросы
- **Следующие шаги**: Логичные дальнейшие действия

### 5. Создание/обновление core dump файла

- Действуй согласно выбору пользователя из шага 0

### 6. Оптимизация для минимального контекста

- Пиши кратко, но информативно
- Используй сокращённые форматы (номера задач, размеры файлов)
- Фокусируйся на actionable-информации, а не на деталях, которые есть в документации
- Сохраняй только то, что может быть утеряно без core dump
- Убедись, что файл легко просмотреть и понять

### 7. Проверка полноты

- Проверь, что все значимые действия сессии зафиксированы
- Убедись, что будущий агент поймёт текущее состояние
- Проверь корректность фиксации изменений файлов
- Удостоверься, что следующие шаги понятны и выполнимы
- Зафиксируй стиль коммуникации и предпочтения пользователя (например, Flutter best practices, мобильные особенности)
