# üçΩÔ∏è Meal Plan Feature

## –û–±–∑–æ—Ä

Meal Plan - —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∏—Ç–∞–Ω–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ NutryFlow, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–æ–∑–¥–∞–≤–∞—Ç—å, —É–ø—Ä–∞–≤–ª—è—Ç—å –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–≤–æ–∏ –ø–ª–∞–Ω—ã –ø–∏—Ç–∞–Ω–∏—è.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫
```
lib/features/meal_plan/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ meal_plan.dart              # –ú–æ–¥–µ–ª—å –ø–ª–∞–Ω–∞ –ø–∏—Ç–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ meal_plan_repository_impl.dart # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îî‚îÄ‚îÄ meal_plan_service.dart      # –°–µ—Ä–≤–∏—Å –ø–ª–∞–Ω–æ–≤ –ø–∏—Ç–∞–Ω–∏—è
‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ meal_plan_entity.dart       # –°—É—â–Ω–æ—Å—Ç—å –ø–ª–∞–Ω–∞ –ø–∏—Ç–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ meal_plan_repository.dart   # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ usecases/
‚îÇ       ‚îú‚îÄ‚îÄ create_meal_plan_usecase.dart    # –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞
‚îÇ       ‚îú‚îÄ‚îÄ get_meal_plans_usecase.dart      # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤
‚îÇ       ‚îî‚îÄ‚îÄ update_meal_plan_usecase.dart    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∞
‚îú‚îÄ‚îÄ presentation/
‚îÇ   ‚îú‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ meal_plan_screen.dart       # –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –ø–ª–∞–Ω–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ meal_details_screen.dart    # –î–µ—Ç–∞–ª–∏ –±–ª—é–¥–∞
‚îÇ   ‚îî‚îÄ‚îÄ widgets/
‚îÇ       ‚îî‚îÄ‚îÄ meal_plan_card.dart         # –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–ª–∞–Ω–∞
‚îî‚îÄ‚îÄ di/
    ‚îî‚îÄ‚îÄ meal_plan_dependencies.dart     # Dependency Injection
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. MealPlan Entity
–ú–æ–¥–µ–ª—å –ø–ª–∞–Ω–∞ –ø–∏—Ç–∞–Ω–∏—è —Å –ø–æ–ª—è–º–∏:
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–∞
- `description` - –æ–ø–∏—Å–∞–Ω–∏–µ
- `meals` - —Å–ø–∏—Å–æ–∫ –±–ª—é–¥
- `createdAt` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `updatedAt` - –¥–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `isActive` - –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ –ø–ª–∞–Ω

### 2. MealPlanService
–°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–ª–∞–Ω–∞–º–∏ –ø–∏—Ç–∞–Ω–∏—è:
- –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–æ–≤
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–ª–∞–Ω–æ–≤
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤
- –£–¥–∞–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤
- –ê–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–ª–∞–Ω–æ–≤

### 3. Meal Details
–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–ª—é–¥–µ:
- –ù–∞–∑–≤–∞–Ω–∏–µ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ
- –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã
- –ü–∏—â–µ–≤–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å
- –í—Ä–µ–º—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è
- –ö–∞—Ç–µ–≥–æ—Ä–∏—è –±–ª—é–¥–∞

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞ –ø–∏—Ç–∞–Ω–∏—è
```dart
final mealPlanService = MealPlanService();
try {
  final mealPlan = await mealPlanService.createMealPlan(
    name: '–ó–¥–æ—Ä–æ–≤—ã–π –∑–∞–≤—Ç—Ä–∞–∫',
    description: '–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–≤—Ç—Ä–∞–∫',
    meals: [breakfastMeal, lunchMeal, dinnerMeal],
  );
} catch (e) {
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤ –ø–∏—Ç–∞–Ω–∏—è
```dart
try {
  final mealPlans = await mealPlanService.getMealPlans();
  // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–æ–≤
} catch (e) {
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∞
```dart
try {
  await mealPlanService.updateMealPlan(
    mealPlan.copyWith(
      name: '–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ',
      isActive: true,
    ),
  );
} catch (e) {
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
}
```

## –ù–∞–≤–∏–≥–∞—Ü–∏—è

### –ú–∞—Ä—à—Ä—É—Ç—ã
- `/meal-plan` - –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –ø–ª–∞–Ω–æ–≤ –ø–∏—Ç–∞–Ω–∏—è
- `/meal-details` - –¥–µ—Ç–∞–ª–∏ –±–ª—é–¥–∞

### –ü—Ä–∏–º–µ—Ä –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
```dart
// –ü–µ—Ä–µ—Ö–æ–¥ –∫ –ø–ª–∞–Ω–∞–º –ø–∏—Ç–∞–Ω–∏—è
Navigator.pushNamed(context, '/meal-plan');

// –ü–µ—Ä–µ—Ö–æ–¥ –∫ –¥–µ—Ç–∞–ª—è–º –±–ª—é–¥–∞
Navigator.push(
  context,
  MaterialPageRoute(
    builder: (context) => MealDetailsScreen(mealName: '–°–∞–ª–∞—Ç –¶–µ–∑–∞—Ä—å'),
  ),
);
```

## –í–∞–ª–∏–¥–∞—Ü–∏—è

### –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è –ø–ª–∞–Ω–∞
```dart
bool isValidPlanName(String name) {
  return name.isNotEmpty && name.length >= 3;
}
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –±–ª—é–¥
```dart
bool isValidMeal(Meal meal) {
  return meal.name.isNotEmpty && 
         meal.ingredients.isNotEmpty &&
         meal.nutritionalValue.calories > 0;
}
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã
```bash
flutter test test/features/meal_plan/
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
- ‚úÖ MealPlanService - 2 —Ç–µ—Å—Ç–∞
- ‚ùå Widgets - —Ç—Ä–µ–±—É—é—Ç—Å—è —Ç–µ—Å—Ç—ã
- ‚ùå Use cases - —Ç—Ä–µ–±—É—é—Ç—Å—è —Ç–µ—Å—Ç—ã

### –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
```dart
const testMealPlan = MealPlan(
  id: 'test-plan-id',
  name: '–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞–Ω',
  description: '–û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–ª–∞–Ω–∞',
  meals: [testMeal1, testMeal2],
  createdAt: DateTime.now(),
  updatedAt: DateTime.now(),
  isActive: true,
);
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø—ã –æ—à–∏–±–æ–∫
- `MealPlanNotFoundException` - –ø–ª–∞–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω
- `ValidationException` - –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `NetworkException` - –æ—à–∏–±–∫–∞ —Å–µ—Ç–∏
- `DuplicateMealPlanException` - –¥—É–±–ª–∏—Ä—É—é—â–∏–π—Å—è –ø–ª–∞–Ω

### –ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏
```dart
try {
  await mealPlanService.createMealPlan(mealPlan);
} on ValidationException catch (e) {
  showError('–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: ${e.message}');
} on DuplicateMealPlanException {
  showError('–ü–ª–∞–Ω —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
} catch (e) {
  showError('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞');
}
```

## –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

### SharedPreferences
```dart
// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∞
await prefs.setString('meal_plan_$id', jsonEncode(mealPlan.toJson()));

// –ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–∞–Ω–∞
final planJson = prefs.getString('meal_plan_$id');
if (planJson != null) {
  final mealPlan = MealPlan.fromJson(jsonDecode(planJson));
}
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü–ª–∞–Ω—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º
- –û—Ñ–ª–∞–π–Ω –ø–æ–¥–¥–µ—Ä–∂–∫–∞

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `shared_preferences` - –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
- `supabase` - Backend as a Service
- `dio` - HTTP –∫–ª–∏–µ–Ω—Ç
- `flutter/material.dart` - UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Supabase –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```dart
// –í main.dart
Supabase.initialize(
  url: 'YOUR_SUPABASE_URL',
  anonKey: 'YOUR_SUPABASE_ANON_KEY',
);
```

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **Data sync** - –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
2. **Offline support** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ñ–ª–∞–π–Ω
3. **Image upload** - –Ω–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–ª—é–¥

## –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

- [ ] –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–ª—é–¥
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
- [ ] –£–ª—É—á—à–∏—Ç—å offline support
- [ ] –î–æ–±–∞–≤–∏—Ç—å —à–∞–±–ª–æ–Ω—ã –ø–ª–∞–Ω–æ–≤
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å sharing –ø–ª–∞–Ω–æ–≤

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∏—á–∏

- **Dashboard** - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤
- **Nutrition** - –ø–∏—â–µ–≤–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å
- **Menu** - —Ä–µ—Ü–µ–ø—Ç—ã –±–ª—é–¥
- **Analytics** - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–∏—Ç–∞–Ω–∏—è
