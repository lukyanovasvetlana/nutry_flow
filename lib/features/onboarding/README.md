# üöÄ Onboarding Feature

## –û–±–∑–æ—Ä

Onboarding - —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–≤–∏—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è NutryFlow, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–≥–∞–µ—Ç –Ω–æ–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–≤–æ–∏ —Ü–µ–ª–∏.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫
```
lib/features/onboarding/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ onboarding_data.dart        # –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ onboarding_repository_impl.dart # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îú‚îÄ‚îÄ onboarding_service.dart     # –°–µ—Ä–≤–∏—Å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
‚îÇ       ‚îî‚îÄ‚îÄ local_storage_service.dart  # –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ onboarding_entity.dart      # –°—É—â–Ω–æ—Å—Ç—å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ onboarding_repository.dart  # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ usecases/
‚îÇ       ‚îú‚îÄ‚îÄ save_onboarding_data_usecase.dart # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ       ‚îî‚îÄ‚îÄ get_onboarding_data_usecase.dart  # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ presentation/
‚îÇ   ‚îú‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ welcome_screen.dart         # –≠–∫—Ä–∞–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile_info_screen.dart    # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ñ–∏–ª–µ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ goals_setup_screen.dart     # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–µ–ª–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ widgets/
‚îÇ       ‚îî‚îÄ‚îÄ onboarding_progress.dart    # –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
‚îî‚îÄ‚îÄ di/
    ‚îî‚îÄ‚îÄ onboarding_dependencies.dart    # Dependency Injection
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. OnboardingData Entity
–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ —Å –ø–æ–ª—è–º–∏:
- `userId` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `step` - —Ç–µ–∫—É—â–∏–π —à–∞–≥
- `profileData` - –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è
- `goalsData` - –¥–∞–Ω–Ω—ã–µ —Ü–µ–ª–µ–π
- `preferencesData` - –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è
- `isCompleted` - –∑–∞–≤–µ—Ä—à–µ–Ω –ª–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥

### 2. OnboardingService
–°–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–æ–º:
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
- –°–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

### 3. LocalStorageService
–°–µ—Ä–≤–∏—Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è:
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
```dart
final onboardingService = OnboardingService();
await onboardingService.initialize();
```

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
```dart
try {
  await onboardingService.saveProgress(
    step: OnboardingStep.profileInfo,
    data: profileData,
  );
} catch (e) {
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
}
```

### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
```dart
try {
  await onboardingService.completeOnboarding();
  // –ü–µ—Ä–µ—Ö–æ–¥ –∫ –≥–ª–∞–≤–Ω–æ–º—É —ç–∫—Ä–∞–Ω—É
} catch (e) {
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
}
```

## –≠–∫—Ä–∞–Ω—ã –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞

### 1. Welcome Screen
- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û–±–∑–æ—Ä —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å"

### 2. Profile Info Screen
- –°–±–æ—Ä –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –ò–º—è, –≤–æ–∑—Ä–∞—Å—Ç, –ø–æ–ª
- –†–æ—Å—Ç –∏ –≤–µ—Å
- –£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### 3. Goals Setup Screen
- –í—ã–±–æ—Ä —Ü–µ–ª–µ–π
- –¶–µ–ª–µ–≤–æ–π –≤–µ—Å
- –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –≤ –ø–∏—Ç–∞–Ω–∏–∏
- –ê–ª–ª–µ—Ä–≥–∏–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

## –ù–∞–≤–∏–≥–∞—Ü–∏—è

### –ú–∞—Ä—à—Ä—É—Ç—ã
- `/welcome` - —ç–∫—Ä–∞–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
- `/profile-info` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ñ–∏–ª–µ
- `/goals-setup` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–µ–ª–µ–π

### –ü—Ä–∏–º–µ—Ä –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
```dart
// –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É
Navigator.pushNamed(context, '/profile-info');

// –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
Navigator.pushReplacementNamed(context, '/dashboard');
```

## –í–∞–ª–∏–¥–∞—Ü–∏—è

### –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è
```dart
bool isValidProfile(ProfileData profile) {
  return profile.firstName.isNotEmpty &&
         profile.age > 0 &&
         profile.height > 0 &&
         profile.weight > 0;
}
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–ª–µ–π
```dart
bool isValidGoals(GoalsData goals) {
  return goals.targetWeight > 0 &&
         goals.activityLevel != null &&
         goals.dietaryPreferences.isNotEmpty;
}
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã
```bash
flutter test test/features/onboarding/
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
- ‚ùå OnboardingService - —Ç—Ä–µ–±—É—é—Ç—Å—è —Ç–µ—Å—Ç—ã
- ‚ùå Widgets - —Ç—Ä–µ–±—É—é—Ç—Å—è —Ç–µ—Å—Ç—ã
- ‚ùå Use cases - —Ç—Ä–µ–±—É—é—Ç—Å—è —Ç–µ—Å—Ç—ã

### –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
```dart
const testOnboardingData = OnboardingData(
  userId: 'test-user-id',
  step: OnboardingStep.profileInfo,
  profileData: testProfileData,
  goalsData: testGoalsData,
  isCompleted: false,
);
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø—ã –æ—à–∏–±–æ–∫
- `OnboardingDataNotFoundException` - –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- `ValidationException` - –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `StorageException` - –æ—à–∏–±–∫–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è
- `NetworkException` - –æ—à–∏–±–∫–∞ —Å–µ—Ç–∏

### –ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏
```dart
try {
  await onboardingService.saveProgress(data);
} on ValidationException catch (e) {
  showError('–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: ${e.message}');
} on StorageException {
  showError('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö');
} catch (e) {
  showError('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞');
}
```

## –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

### SharedPreferences
```dart
// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
await prefs.setString('onboarding_data', jsonEncode(data.toJson()));

// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
final dataJson = prefs.getString('onboarding_data');
if (dataJson != null) {
  final data = OnboardingData.fromJson(jsonDecode(dataJson));
}
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –î–∞–Ω–Ω—ã–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `shared_preferences` - –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
- `supabase` - Backend as a Service
- `dio` - HTTP –∫–ª–∏–µ–Ω—Ç
- `flutter/material.dart` - UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Supabase –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```dart
// –í main.dart
Supabase.initialize(
  url: 'YOUR_SUPABASE_URL',
  anonKey: 'YOUR_SUPABASE_ANON_KEY',
);
```

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **Data persistence** - –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
2. **Offline support** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ñ–ª–∞–π–Ω
3. **Progress tracking** - –Ω–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

## –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

- [ ] –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å skip —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [ ] –£–ª—É—á—à–∏—Ç—å offline support
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—é
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∏—á–∏

- **Auth** - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **Profile** - –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **Dashboard** - –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
